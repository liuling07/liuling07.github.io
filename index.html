<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>残剑博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Hexo theme - Icarus">
<meta property="og:type" content="website">
<meta property="og:title" content="残剑博客">
<meta property="og:url" content="http://liuling07.github.io/index.html">
<meta property="og:site_name" content="残剑博客">
<meta property="og:description" content="Hexo theme - Icarus">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="残剑博客">
<meta name="twitter:description" content="Hexo theme - Icarus">
  
  
    <link rel="icon" href="favicon.png">
  
  
 <link href='//fonts.lug.ustc.edu.cn/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
 <link href="//fonts.lug.ustc.edu.cn/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">


  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css" type="text/css">
  

  

  
</head>
<body>
  <div id="container">
    <header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="/" id="logo"><i class="logo" style="background-image: url(/css/images/logo.png)"></i><span class="site-title">残剑博客</span></a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/.">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/categories">Categories</a>
        
          <a class="main-nav-link" href="/tags">Tags</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      
        <nav id="sub-nav">
          <div class="profile" id="profile-nav">
            <a id="profile-anchor" href="javascript:;"><img class="avatar" src="/css/images/protrait.jpg"><i class="fa fa-caret-down"></i></a>
          </div>
        </nav>
      
      <div id="search-form-wrap">
        
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"> </button><input type="hidden" name="sitesearch" value="http://liuling07.github.io"></form>
        
      </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tr>
        
          <td><a class="main-nav-link" href="/.">Home</a></td>
        
          <td><a class="main-nav-link" href="/archives">Archives</a></td>
        
          <td><a class="main-nav-link" href="/categories">Categories</a></td>
        
          <td><a class="main-nav-link" href="/tags">Tags</a></td>
        
          <td><a class="main-nav-link" href="/about">About</a></td>
        
        <td>
          
            <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="http://liuling07.github.io"></form>
          
        </td>
      </tr>
    </table>
  </div>
</header>

    <div class="outer">
      
        <aside id="profile">
  <div class="inner profile-inner">
    <div class="base-info profile-block">
      <img id="avatar" src="/css/images/protrait.jpg">
      <h2 id="name">Lauren</h2>
      <h3 id="title">Android Developer</h3>
      <span id="location"><i class="fa fa-map-marker"></i>Shenzhen, China</span>
      <a id="follow" href="https://github.com/liuling07">FOLLOW</a>
    </div>
    <div class="article-info profile-block">
      <div class="article-info-block">
        135
        <span>posts</span>
      </div>
      <div class="article-info-block">
        32
        <span>tags</span>
      </div>
    </div>
    
    <div class="contact-info profile-block">
      <table class="contact-list">
        <tr>
          
          <td><a href="https://github.com/liuling07" target="_blank" title="github"><i class="fa fa-github"></i></a></td>
          
          <td><a href="http://weibo.com/LaurenLiuling/" target="_blank" title="weibo"><i class="fa fa-weibo"></i></a></td>
          
          <td><a href="https://plus.google.com/u/0/107098505138563589748/" target="_blank" title="google-plus"><i class="fa fa-google-plus"></i></a></td>
          
          <td><a href="http://stackoverflow.com/users/5629327/lauren-liuling" target="_blank" title="stack-overflow"><i class="fa fa-stack-overflow"></i></a></td>
          
          <td><a href="https://twitter.com/lauren_liuLing/" target="_blank" title="twitter"><i class="fa fa-twitter"></i></a></td>
          
          <td><a href="https://www.facebook.com/lauren.liuling/" target="_blank" title="facebook"><i class="fa fa-facebook"></i></a></td>
          
          <td><a href="/atom.xml" target="_blank" title="rss"><i class="fa fa-rss"></i></a></td>
          
        </tr>
      </table>
    </div>
    
    
  </div>
</aside>

      
      <section id="main">
      <article id="post-say-bye-to-my-2015" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/say-bye-to-my-2015.html">Say bye to my 2015</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2015/12/say-bye-to-my-2015.html">
      <time datetime="2015-12-25T09:25:10.000Z" itemprop="datePublished">2015-12-25</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/人生感悟/">人生感悟</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <h2 id="u6280_u672F_u6210_u957F"><a href="#u6280_u672F_u6210_u957F" class="headerlink" title="技术成长"></a><strong>技术成长</strong></h2><p>14年毕业后开始接触Android，到目前为止从事Android开发差不多一年半的时间，15年算是自己技术成长最大的一年吧。<br>上半年自己大部分精力都耗在云老师项目上，自己既要开发同时兼任项目负责人（这里要感谢老大认可，愿意给新人机会）。前前后后经历了四五次迭代，最终在3个Android新人（确切来说是两个）的努力下完成并上线了。遗憾的是项目不受公司重视，并且部门领导担心影响实体产品的销售而不愿推广。最后随着部门的解散该项目也夭折了，这当时对我来说是很令人伤心的事了。虽然项目夭折了，但是自己从中收获了不少。不仅是技术水平的提升，还收获了项目管理的经验。 </p>
<p>部门解散前，有一个多月时间是比较闲的。利用这段时间自己研究了Android Framework层的源码，搭建了自己的<a href="http://www.liuling123.com/" target="_blank" rel="external">个人技术博客</a>并且接触了开源社区github。贡献了图片选择库<a href="https://github.com/liuling07/PhotoPicker" target="_blank" rel="external">PhotoPicker</a>。<br>部门解散后，到新部门做cocos2dx游戏开发，学习了C++以及cocos2dx引擎。利用下班在家的时间学习了Material Design等知识，并且开发了基于Material Design和MVP模式的新闻客户端<a href="https://github.com/liuling07/SimpleNews" target="_blank" rel="external">SimpleNews</a>。</p>
<h2 id="u8BFB_u4E66"><a href="#u8BFB_u4E66" class="headerlink" title="读书"></a><strong>读书</strong></h2><p>今年看的书不多，看完的有《代码整洁之道》、《极客与团队》、《微管理》、《拆掉思维里的墙》  </p>
<p>未看完的有《从0到1》、《C++ Primer》、《cocos2dX高级开发教程》。</p>
<h2 id="u57F9_u8BAD"><a href="#u57F9_u8BAD" class="headerlink" title="培训"></a><strong>培训</strong></h2><p>今年公司组织两场培训，刘捷老师的《Clean Code》以及MSUP软件工作坊培训。两场培训下来收获都挺大的，尤其是刘捷老师的《Clean Code》课程，培训完之后立马现学现用，为小组制定Android编码规范并且实施代码review。</p>
<h2 id="u953B_u70BC"><a href="#u953B_u70BC" class="headerlink" title="锻炼"></a><strong>锻炼</strong></h2><p>最为程序员，长期坐在电脑前作业，如果没有锻炼的习惯，恐怕身体很难扛得住。自己不爱跑步，对健身房也没兴趣，只喜欢约上几个好友在球场挥洒汗水。</p>
<p>因为鼻骨被撞骨折，14年下半年一直没有碰球，15年春节过后伤好又开始坚持打球了。基本上每周三晚上都和同事在篮球公园包场打。后来部门解散，同事回总部的回总部，离职的离职，最后篮球活动也取消了。之后就每周日早上和同学在宝体打，一直坚持到现在。</p>
<h2 id="15_u5E74_u5927_u4E8B_u8BB0"><a href="#15_u5E74_u5927_u4E8B_u8BB0" class="headerlink" title="15年大事记"></a><strong>15年大事记</strong></h2><p>第一次去女朋友家里，并商讨婚嫁事宜，这算是我人生中一件大事了吧。  </p>
<p>下了血本买了台中配Mac pro。对于生产工具一定要买所能承受范围内最好的。  </p>
<p>搭建自己的<a href="http://www.liuling123.com/" target="_blank" rel="external">个人技术博客</a>，并且开始接触开源社区，并在github和微博上关注了很多业界大牛。</p>
<h2 id="16_u5E74_u5C55_u671B"><a href="#16_u5E74_u5C55_u671B" class="headerlink" title="16年展望"></a><strong>16年展望</strong></h2><p>首先得找一份自己满意的Android研发工作，因为自己对游戏开发（儿童游戏，略感弱智）没有太大兴趣；  </p>
<p>努力提升自己的技术水平，向业界大牛靠拢；  </p>
<p>多向github贡献代码，经常更新自己的技术博客；  </p>
<p>看完Simple哥送的《Android软件安全与逆向分析》（感谢Simple哥 <a href="https://github.com/bboyfeiyu" target="_blank" rel="external">@bboyfeiyu</a> ）,看完徐医生的《Android群英传》； </p>
<p>和女朋友订婚；</p>
<p><a href="https://github.com/winter-fall/Bye2015Hi2016/issues/30" target="_blank" rel="external">https://github.com/winter-fall/Bye2015Hi2016/issues/30</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liuling07.github.io/2015/12/say-bye-to-my-2015.html" data-id="ciiy5f4qk002pq1d0dnswwvam" class="article-share-link">Share</a>
      
        <a href="http://liuling07.github.io/2015/12/say-bye-to-my-2015.html#ds-thread" class="article-comment-link">Comments</a>
      
      
    </footer>
  </div>
  
</article>



    
      <article id="post-mvp-pattern-android" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/mvp-pattern-android.html">MVP模式在Android项目中的使用</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2015/12/mvp-pattern-android.html">
      <time datetime="2015-12-23T14:16:04.000Z" itemprop="datePublished">2015-12-23</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Android/">Android</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p> 以前在写项目的时候，没有过多考虑架构模式的问题，因为之前一直做J2EE开发，而J2EE都是采用MVC模式进行开发的，所以在搭建公司项目的时候，也是使用类似MVC的架构（严格来讲，之前的项目还算不上MVC模式，只是简单将网络请求与界面分离，然后通过Handle通知更新界面）。这种写法，在后面随着项目越来越大，Activty或者Fragment中代码也会越来越多，导致项目的维护变的越来越复杂。所以需要另外一种架构模式来解决这个问题，在网上浏览了一圈，发现适合Android开发的架构模式非MVP莫属了。</p>
<p>网上一搜，讲MVP模式的文章比比皆是。但是大多都是讲理论，稍微好点的会附带一个简单的登录的demo。一个简单的demo很难让初次接触MVP模式的人掌握它的使用。所以我决定写一个稍微复杂一点的新闻客户端SimpleNews（当然只是相对登录的demo）来展示MVP在具体项目中的使用。另外SimpleNews还使用了Material Design，也是学习Material Design的一个好Demo。</p>
<p>好了，切入正文吧。先讲一下MVP的概念。</p>
<h3 id="u4EC0_u4E48_u662FMVP"><a href="#u4EC0_u4E48_u662FMVP" class="headerlink" title="什么是MVP"></a>什么是MVP</h3><p>MVP是模型（Model）、视图（View）、主持人（Presenter）的缩写，分别代表项目中3个不同的模块。</p>
<ul>
<li><p>模型（Model）：负责处理数据的加载或者存储，比如从网络或本地数据库获取数据等；</p>
</li>
<li><p>视图（View）：负责界面数据的展示，与用户进行交互；</p>
</li>
<li><p>主持人（Presenter）：相当于协调者，是模型与视图之间的桥梁，将模型与视图分离开来。</p>
</li>
</ul>
<p>如下图所示，View与Model并不直接交互，而是使用Presenter作为View与Model之间的桥梁。其中Presenter中同时持有Viwe层以及Model层的Interface的引用，而View层持有Presenter层Interface的引用。当View层某个界面需要展示某些数据的时候，首先会调用Presenter层的某个接口，然后Presenter层会调用Model层请求数据，当Model层数据加载成功之后会调用Presenter层的回调方法通知Presenter层数据加载完毕，最后Presenter层再调用View层的接口将加载后的数据展示给用户。这就是MVP模式的整个核心过程。<br><img src="http://7xnqm4.com1.z0.glb.clouddn.com/Android中MVP的使用%C2%8F%C2%9B.png" alt="图片描述"></p>
<p>这样分层的好处就是大大减少了Model与View层之间的耦合度。一方面可以使得View层和Model层单独开发与测试，互不依赖。另一方面Model层可以封装复用，可以极大的减少代码量。当然，MVP还有其他的一些优点，这里不再赘述。下面看下MVP模式在具体项目中的使用。</p>
<h3 id="MVP_u6A21_u5F0F_u5728_u9879_u76EE_u4E2D_u7684_u4F7F_u7528"><a href="#MVP_u6A21_u5F0F_u5728_u9879_u76EE_u4E2D_u7684_u4F7F_u7528" class="headerlink" title="MVP模式在项目中的使用"></a>MVP模式在项目中的使用</h3><h4 id="View_u5C42"><a href="#View_u5C42" class="headerlink" title="View层"></a>View层</h4><p>View层新闻展示模块的是组件是Fragment，里面有一个RecyclerView、SwipeRefreshLayout。布局代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#60;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&#62;&#10;&#60;android.support.v4.widget.SwipeRefreshLayout&#10;    xmlns:android=&#34;http://schemas.android.com/apk/res/android&#34;&#10;    xmlns:app=&#34;http://schemas.android.com/apk/res-auto&#34;&#10;    android:id=&#34;@+id/swipe_refresh_widget&#34;&#10;    android:layout_width=&#34;match_parent&#34;&#10;    android:layout_height=&#34;match_parent&#34;&#62;&#10;    &#60;android.support.v7.widget.RecyclerView&#10;        android:id=&#34;@+id/recycle_view&#34;&#10;        android:layout_width=&#34;match_parent&#34;&#10;        android:layout_height=&#34;wrap_content&#34;&#10;        android:scrollbars=&#34;vertical&#34;&#10;        app:layout_behavior=&#34;@string/appbar_scrolling_view_behavior&#34;&#10;        android:paddingTop=&#34;@dimen/card_margin&#34;&#62;&#10;    &#60;/android.support.v7.widget.RecyclerView&#62;&#10;&#60;/android.support.v4.widget.SwipeRefreshLayout&#62;</span><br></pre></td></tr></table></figure>
<p>新闻列表模块主要是展示从网络获取的新闻列表信息，View层的接口大概需要如下方法：</p>
<ol>
<li>加载数据的过程中需要提示“正在加载”的反馈信息给用户</li>
<li>加载成功后，将加载得到的数据填充到RecyclerView展示给用户</li>
<li>加载成功后，需要将“正在加载”反馈信息取消掉</li>
<li>若加载数据失败，如无网络连接，则需要给用户提示信息</li>
</ol>
<p>根据上面描述，我们将View层的接口定义如下，分别对应上面四个方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public interface NewsView &#123;&#10;    void showProgress();&#10;    void addNews(List&#60;NewsBean&#62; newsList);&#10;    void hideProgress();&#10;    void showLoadFailMsg();&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>在新闻列表Fragment中实现上述接口：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">package com.lauren.simplenews.news.widget;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.support.annotation.Nullable;&#10;import android.support.design.widget.Snackbar;&#10;import android.support.v4.app.ActivityCompat;&#10;import android.support.v4.app.ActivityOptionsCompat;&#10;import android.support.v4.app.Fragment;&#10;import android.support.v4.widget.SwipeRefreshLayout;&#10;import android.support.v7.widget.DefaultItemAnimator;&#10;import android.support.v7.widget.LinearLayoutManager;&#10;import android.support.v7.widget.RecyclerView;&#10;import android.view.LayoutInflater;&#10;import android.view.View;&#10;import android.view.ViewGroup;&#10;import com.lauren.simplenews.R;&#10;import com.lauren.simplenews.beans.NewsBean;&#10;import com.lauren.simplenews.commons.Urls;&#10;import com.lauren.simplenews.news.NewsAdapter;&#10;import com.lauren.simplenews.news.presenter.NewsPresenter;&#10;import com.lauren.simplenews.news.presenter.NewsPresenterImpl;&#10;import com.lauren.simplenews.news.view.NewsView;&#10;import com.lauren.simplenews.utils.LogUtils;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;/**&#10; * Description : &#26032;&#38395;Fragment&#10; * Author : lauren&#10; * Email  : lauren.liuling@gmail.com&#10; * Blog   : http://www.liuling123.com&#10; * Date   : 15/12/13&#10; */&#10;public class NewsListFragment extends Fragment implements NewsView, SwipeRefreshLayout.OnRefreshListener &#123;&#10;    private static final String TAG = &#34;NewsListFragment&#34;;&#10;    private SwipeRefreshLayout mSwipeRefreshWidget;&#10;    private RecyclerView mRecyclerView;&#10;    private LinearLayoutManager mLayoutManager;&#10;    private NewsAdapter mAdapter;&#10;    private List&#60;NewsBean&#62; mData;&#10;    private NewsPresenter mNewsPresenter;&#10;    private int mType = NewsFragment.NEWS_TYPE_TOP;&#10;    private int pageIndex = 0;&#10;    public static NewsListFragment newInstance(int type) &#123;&#10;        Bundle args = new Bundle();&#10;        NewsListFragment fragment = new NewsListFragment();&#10;        args.putInt(&#34;type&#34;, type);&#10;        fragment.setArguments(args);&#10;        return fragment;&#10;    &#125;&#10;    @Override&#10;    public void onCreate(@Nullable Bundle savedInstanceState) &#123;&#10;        super.onCreate(savedInstanceState);&#10;        mNewsPresenter = new NewsPresenterImpl(this);&#10;        mType = getArguments().getInt(&#34;type&#34;);&#10;    &#125;&#10;    @Nullable&#10;    @Override&#10;    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) &#123;&#10;        View view = inflater.inflate(R.layout.fragment_newslist, null);&#10;        mSwipeRefreshWidget = (SwipeRefreshLayout) view.findViewById(R.id.swipe_refresh_widget);&#10;        mSwipeRefreshWidget.setColorSchemeResources(R.color.primary,&#10;                R.color.primary_dark, R.color.primary_light,&#10;                R.color.accent);&#10;        mSwipeRefreshWidget.setOnRefreshListener(this);&#10;        mRecyclerView = (RecyclerView)view.findViewById(R.id.recycle_view);&#10;        mRecyclerView.setHasFixedSize(true);&#10;        mLayoutManager = new LinearLayoutManager(getActivity());&#10;        mRecyclerView.setLayoutManager(mLayoutManager);&#10;        mRecyclerView.setItemAnimator(new DefaultItemAnimator());&#10;        mAdapter = new NewsAdapter(getActivity().getApplicationContext());&#10;        mAdapter.setOnItemClickListener(mOnItemClickListener);&#10;        mRecyclerView.setAdapter(mAdapter);&#10;        mRecyclerView.setOnScrollListener(mOnScrollListener);&#10;        onRefresh();&#10;        return view;&#10;    &#125;&#10;    private RecyclerView.OnScrollListener mOnScrollListener = new RecyclerView.OnScrollListener() &#123;&#10;        private int lastVisibleItem;&#10;        @Override&#10;        public void onScrolled(RecyclerView recyclerView, int dx, int dy) &#123;&#10;            super.onScrolled(recyclerView, dx, dy);&#10;            lastVisibleItem = mLayoutManager.findLastVisibleItemPosition();&#10;        &#125;&#10;        @Override&#10;        public void onScrollStateChanged(RecyclerView recyclerView, int newState) &#123;&#10;            super.onScrollStateChanged(recyclerView, newState);&#10;            if (newState == RecyclerView.SCROLL_STATE_IDLE&#10;                    &#38;&#38; lastVisibleItem + 1 == mAdapter.getItemCount()&#10;                    &#38;&#38; mAdapter.isShowFooter()) &#123;&#10;                //&#21152;&#36733;&#26356;&#22810;&#10;                LogUtils.d(TAG, &#34;loading more data&#34;);&#10;                mNewsPresenter.loadNews(mType, pageIndex + Urls.PAZE_SIZE);&#10;            &#125;&#10;        &#125;&#10;    &#125;;&#10;    private NewsAdapter.OnItemClickListener mOnItemClickListener = new NewsAdapter.OnItemClickListener() &#123;&#10;        @Override&#10;        public void onItemClick(View view, int position) &#123;&#10;            NewsBean news = mAdapter.getItem(position);&#10;            Intent intent = new Intent(getActivity(), NewsDetailActivity.class);&#10;            intent.putExtra(&#34;news&#34;, news);&#10;            View transitionView = view.findViewById(R.id.ivNews);&#10;            ActivityOptionsCompat options =&#10;                    ActivityOptionsCompat.makeSceneTransitionAnimation(getActivity(),&#10;                            transitionView, getString(R.string.transition_news_img));&#10;            ActivityCompat.startActivity(getActivity(), intent, options.toBundle());&#10;        &#125;&#10;    &#125;;&#10;    @Override&#10;    public void showProgress() &#123;&#10;        mSwipeRefreshWidget.setRefreshing(true);&#10;    &#125;&#10;    @Override&#10;    public void addNews(List&#60;NewsBean&#62; newsList) &#123;&#10;        mAdapter.isShowFooter(true);&#10;        if(mData == null) &#123;&#10;            mData = new ArrayList&#60;NewsBean&#62;();&#10;        &#125;&#10;        mData.addAll(newsList);&#10;        if(pageIndex == 0) &#123;&#10;            mAdapter.setmDate(mData);&#10;        &#125; else &#123;&#10;            //&#22914;&#26524;&#27809;&#26377;&#26356;&#22810;&#25968;&#25454;&#20102;,&#21017;&#38544;&#34255;footer&#24067;&#23616;&#10;            if(newsList == null || newsList.size() == 0) &#123;&#10;                mAdapter.isShowFooter(false);&#10;            &#125;&#10;            mAdapter.notifyDataSetChanged();&#10;        &#125;&#10;        pageIndex += Urls.PAZE_SIZE;&#10;    &#125;&#10;    @Override&#10;    public void hideProgress() &#123;&#10;        mSwipeRefreshWidget.setRefreshing(false);&#10;    &#125;&#10;    @Override&#10;    public void showLoadFailMsg() &#123;&#10;        if(pageIndex == 0) &#123;&#10;            mAdapter.isShowFooter(false);&#10;            mAdapter.notifyDataSetChanged();&#10;        &#125;&#10;        Snackbar.make(getActivity().findViewById(R.id.drawer_layout), getString(R.string.load_fail), Snackbar.LENGTH_SHORT).show();&#10;    &#125;&#10;    @Override&#10;    public void onRefresh() &#123;&#10;        pageIndex = 0;&#10;        if(mData != null) &#123;&#10;            mData.clear();&#10;        &#125;&#10;        mNewsPresenter.loadNews(mType, pageIndex);&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="Model_u5C42"><a href="#Model_u5C42" class="headerlink" title="Model层"></a>Model层</h4><p>新闻模块的model主要负责从服务器获取新闻列表信息，接口代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public interface NewsModel &#123;&#10;    void loadNews(String url, int type, NewsModelImpl.OnLoadNewsListListener listener);&#10;    ......&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>实现如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">package com.lauren.simplenews.news.model;&#10;import com.lauren.simplenews.beans.NewsBean;&#10;import com.lauren.simplenews.beans.NewsDetailBean;&#10;import com.lauren.simplenews.commons.Urls;&#10;import com.lauren.simplenews.news.NewsJsonUtils;&#10;import com.lauren.simplenews.news.widget.NewsFragment;&#10;import com.lauren.simplenews.utils.OkHttpUtils;&#10;import java.util.List;&#10;/**&#10; * Description : &#26032;&#38395;&#19994;&#21153;&#22788;&#29702;&#31867;&#10; * Author : lauren&#10; * Email  : lauren.liuling@gmail.com&#10; * Blog   : http://www.liuling123.com&#10; * Date   : 15/12/19&#10; */&#10;public class NewsModelImpl implements NewsModel &#123;&#10;    /**&#10;     * &#21152;&#36733;&#26032;&#38395;&#21015;&#34920;&#10;     * @param url&#10;     * @param listener&#10;     */&#10;    @Override&#10;    public void loadNews(String url, final int type, final OnLoadNewsListListener listener) &#123;&#10;        OkHttpUtils.ResultCallback&#60;String&#62; loadNewsCallback = new OkHttpUtils.ResultCallback&#60;String&#62;() &#123;&#10;            @Override&#10;            public void onSuccess(String response) &#123;&#10;                List&#60;NewsBean&#62; newsBeanList = NewsJsonUtils.readJsonNewsBeans(response, getID(type));&#10;                listener.onSuccess(newsBeanList);&#10;            &#125;&#10;            @Override&#10;            public void onFailure(Exception e) &#123;&#10;                listener.onFailure(&#34;load news list failure.&#34;, e);&#10;            &#125;&#10;        &#125;;&#10;        OkHttpUtils.get(url, loadNewsCallback);&#10;    &#125;&#10;    ......&#10;    /**&#10;     * &#33719;&#21462;ID&#10;     * @param type&#10;     * @return&#10;     */&#10;    private String getID(int type) &#123;&#10;        String id;&#10;        switch (type) &#123;&#10;            case NewsFragment.NEWS_TYPE_TOP:&#10;                id = Urls.TOP_ID;&#10;                break;&#10;            case NewsFragment.NEWS_TYPE_NBA:&#10;                id = Urls.NBA_ID;&#10;                break;&#10;            case NewsFragment.NEWS_TYPE_CARS:&#10;                id = Urls.CAR_ID;&#10;                break;&#10;            case NewsFragment.NEWS_TYPE_JOKES:&#10;                id = Urls.JOKE_ID;&#10;                break;&#10;            default:&#10;                id = Urls.TOP_ID;&#10;                break;&#10;        &#125;&#10;        return id;&#10;    &#125;&#10;    private String getDetailUrl(String docId) &#123;&#10;        StringBuffer sb = new StringBuffer(Urls.NEW_DETAIL);&#10;        sb.append(docId).append(Urls.END_DETAIL_URL);&#10;        return sb.toString();&#10;    &#125;&#10;    public interface OnLoadNewsListListener &#123;&#10;        void onSuccess(List&#60;NewsBean&#62; list);&#10;        void onFailure(String msg, Exception e);&#10;    &#125;&#10;    ......&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>网络请求使用开源项目OkHttp，OkHttpUtils是对其的封装，具体代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">package com.lauren.simplenews.utils;&#10;import android.os.Handler;&#10;import android.os.Looper;&#10;import com.google.gson.internal.$Gson$Types;&#10;import com.squareup.okhttp.Callback;&#10;import com.squareup.okhttp.FormEncodingBuilder;&#10;import com.squareup.okhttp.OkHttpClient;&#10;import com.squareup.okhttp.Request;&#10;import com.squareup.okhttp.RequestBody;&#10;import com.squareup.okhttp.Response;&#10;import java.io.IOException;&#10;import java.lang.reflect.ParameterizedType;&#10;import java.lang.reflect.Type;&#10;import java.net.CookieManager;&#10;import java.net.CookiePolicy;&#10;import java.util.List;&#10;import java.util.concurrent.TimeUnit;&#10;/**&#10; * Description : OkHttp&#32593;&#32476;&#36830;&#25509;&#23553;&#35013;&#24037;&#20855;&#31867;&#10; * Author : lauren&#10; * Email  : lauren.liuling@gmail.com&#10; * Blog   : http://www.liuling123.com&#10; * Date   : 15/12/17&#10; */&#10;public class OkHttpUtils &#123;&#10;    private static final String TAG = &#34;OkHttpUtils&#34;;&#10;    private static OkHttpUtils mInstance;&#10;    private OkHttpClient mOkHttpClient;&#10;    private Handler mDelivery;&#10;    private OkHttpUtils() &#123;&#10;        mOkHttpClient = new OkHttpClient();&#10;        mOkHttpClient.setConnectTimeout(10, TimeUnit.SECONDS);&#10;        mOkHttpClient.setWriteTimeout(10, TimeUnit.SECONDS);&#10;        mOkHttpClient.setReadTimeout(30, TimeUnit.SECONDS);&#10;        //cookie enabled&#10;        mOkHttpClient.setCookieHandler(new CookieManager(null, CookiePolicy.ACCEPT_ORIGINAL_SERVER));&#10;        mDelivery = new Handler(Looper.getMainLooper());&#10;    &#125;&#10;    private synchronized static OkHttpUtils getmInstance() &#123;&#10;        if (mInstance == null) &#123;&#10;            mInstance = new OkHttpUtils();&#10;        &#125;&#10;        return mInstance;&#10;    &#125;&#10;    private void getRequest(String url, final ResultCallback callback) &#123;&#10;        final Request request = new Request.Builder().url(url).build();&#10;        deliveryResult(callback, request);&#10;    &#125;&#10;    private void postRequest(String url, final ResultCallback callback, List&#60;Param&#62; params) &#123;&#10;        Request request = buildPostRequest(url, params);&#10;        deliveryResult(callback, request);&#10;    &#125;&#10;    private void deliveryResult(final ResultCallback callback, Request request) &#123;&#10;        mOkHttpClient.newCall(request).enqueue(new Callback() &#123;&#10;            @Override&#10;            public void onFailure(Request request, final IOException e) &#123;&#10;                sendFailCallback(callback, e);&#10;            &#125;&#10;            @Override&#10;            public void onResponse(Response response) throws IOException &#123;&#10;                try &#123;&#10;                    String str = response.body().string();&#10;                    if (callback.mType == String.class) &#123;&#10;                        sendSuccessCallBack(callback, str);&#10;                    &#125; else &#123;&#10;                        Object object = JsonUtils.deserialize(str, callback.mType);&#10;                        sendSuccessCallBack(callback, object);&#10;                    &#125;&#10;                &#125; catch (final Exception e) &#123;&#10;                    LogUtils.e(TAG, &#34;convert json failure&#34;, e);&#10;                    sendFailCallback(callback, e);&#10;                &#125;&#10;            &#125;&#10;        &#125;);&#10;    &#125;&#10;    private void sendFailCallback(final ResultCallback callback, final Exception e) &#123;&#10;        mDelivery.post(new Runnable() &#123;&#10;            @Override&#10;            public void run() &#123;&#10;                if (callback != null) &#123;&#10;                    callback.onFailure(e);&#10;                &#125;&#10;            &#125;&#10;        &#125;);&#10;    &#125;&#10;    private void sendSuccessCallBack(final ResultCallback callback, final Object obj) &#123;&#10;        mDelivery.post(new Runnable() &#123;&#10;            @Override&#10;            public void run() &#123;&#10;                if (callback != null) &#123;&#10;                    callback.onSuccess(obj);&#10;                &#125;&#10;            &#125;&#10;        &#125;);&#10;    &#125;&#10;    private Request buildPostRequest(String url, List&#60;Param&#62; params) &#123;&#10;        FormEncodingBuilder builder = new FormEncodingBuilder();&#10;        for (Param param : params) &#123;&#10;            builder.add(param.key, param.value);&#10;        &#125;&#10;        RequestBody requestBody = builder.build();&#10;        return new Request.Builder().url(url).post(requestBody).build();&#10;    &#125;&#10;    /**********************&#23545;&#22806;&#25509;&#21475;************************/&#10;    /**&#10;     * get&#35831;&#27714;&#10;     * @param url  &#35831;&#27714;url&#10;     * @param callback  &#35831;&#27714;&#22238;&#35843;&#10;     */&#10;    public static void get(String url, ResultCallback callback) &#123;&#10;        getmInstance().getRequest(url, callback);&#10;    &#125;&#10;    /**&#10;     * post&#35831;&#27714;&#10;     * @param url       &#35831;&#27714;url&#10;     * @param callback  &#35831;&#27714;&#22238;&#35843;&#10;     * @param params    &#35831;&#27714;&#21442;&#25968;&#10;     */&#10;    public static void post(String url, final ResultCallback callback, List&#60;Param&#62; params) &#123;&#10;        getmInstance().postRequest(url, callback, params);&#10;    &#125;&#10;    /**&#10;     * http&#35831;&#27714;&#22238;&#35843;&#31867;,&#22238;&#35843;&#26041;&#27861;&#22312;UI&#32447;&#31243;&#20013;&#25191;&#34892;&#10;     * @param &#60;T&#62;&#10;     */&#10;    public static abstract class ResultCallback&#60;T&#62; &#123;&#10;        Type mType;&#10;        public ResultCallback()&#123;&#10;            mType = getSuperclassTypeParameter(getClass());&#10;        &#125;&#10;        static Type getSuperclassTypeParameter(Class&#60;?&#62; subclass) &#123;&#10;            Type superclass = subclass.getGenericSuperclass();&#10;            if (superclass instanceof Class) &#123;&#10;                throw new RuntimeException(&#34;Missing type parameter.&#34;);&#10;            &#125;&#10;            ParameterizedType parameterized = (ParameterizedType) superclass;&#10;            return $Gson$Types.canonicalize(parameterized.getActualTypeArguments()[0]);&#10;        &#125;&#10;        /**&#10;         * &#35831;&#27714;&#25104;&#21151;&#22238;&#35843;&#10;         * @param response&#10;         */&#10;        public abstract void onSuccess(T response);&#10;        /**&#10;         * &#35831;&#27714;&#22833;&#36133;&#22238;&#35843;&#10;         * @param e&#10;         */&#10;        public abstract void onFailure(Exception e);&#10;    &#125;&#10;    /**&#10;     * post&#35831;&#27714;&#21442;&#25968;&#31867;&#10;     */&#10;    public static class Param &#123;&#10;        String key;&#10;        String value;&#10;        public Param() &#123;&#10;        &#125;&#10;        public Param(String key, String value) &#123;&#10;            this.key = key;&#10;            this.value = value;&#10;        &#125;&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>将网络请求进行封装可以减少很多的代码量，并且后期如果我不想用okhttp了，想换成其它的库，修改起来也方便。</p>
<h4 id="Presenter_u5C42"><a href="#Presenter_u5C42" class="headerlink" title="Presenter层"></a>Presenter层</h4><p>View层需要调用Presenter层加载新闻信息，所以Presenter需要提供加载新闻信息的接口：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public interface NewsPresenter &#123;&#10;    void loadNews(int type, int page);&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>NewsPresenterImpl的构造函数中需要传入View层的接口对象NewView，并且需要创建一个NewsModel对象。Presenter的具体实现：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">package com.lauren.simplenews.news.presenter;&#10;import com.lauren.simplenews.beans.NewsBean;&#10;import com.lauren.simplenews.commons.Urls;&#10;import com.lauren.simplenews.news.model.NewsModel;&#10;import com.lauren.simplenews.news.model.NewsModelImpl;&#10;import com.lauren.simplenews.news.view.NewsView;&#10;import com.lauren.simplenews.news.widget.NewsFragment;&#10;import com.lauren.simplenews.utils.LogUtils;&#10;import java.util.List;&#10;/**&#10; * Description :&#10; * Author : lauren&#10; * Email  : lauren.liuling@gmail.com&#10; * Blog   : http://www.liuling123.com&#10; * Date   : 15/12/18&#10; */&#10;public class NewsPresenterImpl implements NewsPresenter, NewsModelImpl.OnLoadNewsListListener &#123;&#10;    private static final String TAG = &#34;NewsPresenterImpl&#34;;&#10;    private NewsView mNewsView;&#10;    private NewsModel mNewsModel;&#10;    public NewsPresenterImpl(NewsView newsView) &#123;&#10;        this.mNewsView = newsView;&#10;        this.mNewsModel = new NewsModelImpl();&#10;    &#125;&#10;    @Override&#10;    public void loadNews(final int type, final int pageIndex) &#123;&#10;        String url = getUrl(type, pageIndex);&#10;        LogUtils.d(TAG, url);&#10;        //&#21482;&#26377;&#31532;&#19968;&#39029;&#30340;&#25110;&#32773;&#21047;&#26032;&#30340;&#26102;&#20505;&#25165;&#26174;&#31034;&#21047;&#26032;&#36827;&#24230;&#26465;&#10;        if(pageIndex == 0) &#123;&#10;            mNewsView.showProgress();&#10;        &#125;&#10;        mNewsModel.loadNews(url, type, this);&#10;    &#125;&#10;    /**&#10;     * &#26681;&#25454;&#31867;&#21035;&#21644;&#39029;&#38754;&#32034;&#24341;&#21019;&#24314;url&#10;     * @param type&#10;     * @param pageIndex&#10;     * @return&#10;     */&#10;    private String getUrl(int type, int pageIndex) &#123;&#10;        StringBuffer sb = new StringBuffer();&#10;        switch (type) &#123;&#10;            case NewsFragment.NEWS_TYPE_TOP:&#10;                sb.append(Urls.TOP_URL).append(Urls.TOP_ID);&#10;                break;&#10;            case NewsFragment.NEWS_TYPE_NBA:&#10;                sb.append(Urls.COMMON_URL).append(Urls.NBA_ID);&#10;                break;&#10;            case NewsFragment.NEWS_TYPE_CARS:&#10;                sb.append(Urls.COMMON_URL).append(Urls.CAR_ID);&#10;                break;&#10;            case NewsFragment.NEWS_TYPE_JOKES:&#10;                sb.append(Urls.COMMON_URL).append(Urls.JOKE_ID);&#10;                break;&#10;            default:&#10;                sb.append(Urls.TOP_URL).append(Urls.TOP_ID);&#10;                break;&#10;        &#125;&#10;        sb.append(&#34;/&#34;).append(pageIndex).append(Urls.END_URL);&#10;        return sb.toString();&#10;    &#125;&#10;    @Override&#10;    public void onSuccess(List&#60;NewsBean&#62; list) &#123;&#10;        mNewsView.hideProgress();&#10;        mNewsView.addNews(list);&#10;    &#125;&#10;    @Override&#10;    public void onFailure(String msg, Exception e) &#123;&#10;        mNewsView.hideProgress();&#10;        mNewsView.showLoadFailMsg();&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>当用户切换到NewsListFragment界面之后，界面需要展示新闻列表信息给用户。首先NewsListFragment会调用NewsPresenter的loadNews方法，NewsPresenter 的loadNews方法中又会调用NewsModel中的loadNews方法。NewsModel中的loadNews方法中就是加载数据的核心，通过Okhttp请求服务器接口获取数据，无论数据获取成功与否，都会通过OnLoadNewsListener接口回调给NewsPresenter 。如果获取成功，NewsPresenter 会调用NewsView的addNews方法将获取的新闻列表信息展示到RecyclerView。如果获取失败，则调用NewsView的showLoadFialMsg方法向用户提示失败信息。</p>
<p>以上就是新闻列表请求的整个过程。</p>
<p>源码地址：<a href="https://github.com/liuling07/SimpleNews" target="_blank" rel="external">https://github.com/liuling07/SimpleNews</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liuling07.github.io/2015/12/mvp-pattern-android.html" data-id="ciiy5f4s60054q1d063esg1bz" class="article-share-link">Share</a>
      
        <a href="http://liuling07.github.io/2015/12/mvp-pattern-android.html#ds-thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVP/">MVP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-intent-resolving-in-android-m" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/intent-resolving-in-android-m.html">【译文】Android M中Intent的解析</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2015/12/intent-resolving-in-android-m.html">
      <time datetime="2015-12-04T06:52:06.000Z" itemprop="datePublished">2015-12-04</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Android/">Android</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>原文链接 : <a href="https://medium.com/google-developer-experts/intent-resolving-in-android-m-c17d39d27048#.n23z2g14e" target="_blank" rel="external">Intent Resolving in Android M</a><br>原文作者 : <a href="https://medium.com/@tasomaniac" target="_blank" rel="external">Said Tahsin Dane</a><br>译文出自 : <a href="http://www.devtf.cn" target="_blank" rel="external">开发技术前线 www.devtf.cn。未经允许，不得转载!</a><br>译者 : <a href="https://github.com/liuling07" target="_blank" rel="external">liuling07</a><br>校对者: <a href="https://github.com/desmond1121" target="_blank" rel="external">desmond1121</a><br>状态 : 完成</p>
<h2 id="u8BD1_u6587_u8FDE_u63A5_uFF1AAndroid_M_u4E2DIntent_u7684_u89E3_u6790"><a href="#u8BD1_u6587_u8FDE_u63A5_uFF1AAndroid_M_u4E2DIntent_u7684_u89E3_u6790" class="headerlink" title="译文连接：Android M中Intent的解析"></a>译文连接：<a href="https://github.com/bboyfeiyu/android-tech-frontier/tree/master/others/Android-M中Intent的解析" target="_blank" rel="external">Android M中Intent的解析</a></h2><p>注意了！在Android 6.0中，“隐式Intent”的解析不能像之前版本那样正常工作了。这很有可能导致你的app不能正常使用。</p>
<p>现在让我解释一下这个意料之中的问题以及为什么它不能正常使用： 最近，我正在开发一个小的开源项目，叫做“Open Link With”。希望不久后它能够在应用市场上架。</p>
<p>我的这个app能够让你在其他app之间随意切换。当你给我分享一个链接的时候，我基本上可以根据这个链接查询出所有可以处理这个链接的Activity。然后我会模拟一个系统对话框让你切换app。</p>
<p><img src="https://cdn-images-1.medium.com/max/1600/1*rW8I8aCpJ2q8fnfKH_51_g.gif" alt="从已经打开的youtube的web页面切换到youtube应用" title="从已经打开的youtube的web页面切换到youtube应用"></p>
<p>我一直都是使用下面的方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&#60;ResolveInfo&#62; infos = packageManager&#10;        .queryIntentActivities(intent, MATCH_DEFAULT_ONLY);</span><br></pre></td></tr></table></figure></p>
<p>这段代码几乎所有Android开发者都比较熟悉，并且我也相信大部分app都有用到这段代码。</p>
<p>我的手机里有两个浏览器。“一个URL是Google+ 的Intent”期望得到一个具有3个ResolveInfo对象的列表（Google+应用以及两个浏览器）。</p>
<p>好吧，并不是这样！</p>
<p>欢迎来到Android 6.0！</p>
<p>Android 6.0引进了应用关联。系统主要通过你的web页面来认证，并且自动使用你的app来打开这些URL，而不会向你做任何请求。或者你可以到系统设置，选择“应用程序”，然后点击一个应用，再点击“默认打开方式”，然后设置“用这个应用打开”，就可以每次都使用这个应用打开。</p>
<p><img src="https://cdn-images-1.medium.com/max/800/1*MVZbYKhwu-7qnyGAFWuNsw.png" alt="Android 6.0的应用默认设置页面" title="Android 6.0的应用默认设置页面"></p>
<p>在这种情况下，queryIntentActivities方法只会给开发者返回一个只有一个Activity的列表（此例子返回的是Google+）。</p>
<p>虽然这是在意料之中的，但是应该在文档中注明，因为它与公共API相矛盾了。</p>
<p>我研究了一下，发现了一个MATCH_ALL标志，文档表示，它将禁用所有的系统级过滤器。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/**&#10; * Querying flag: if set and if the platform is doing any filtering of the results, then&#10; * the filtering will not happen. This is a synonym for saying that all results should&#10; * be returned.&#10; */&#10;public static final int MATCH_ALL = 0x00020000;</span><br></pre></td></tr></table></figure>
<p>这对我来说没什么用。我打开源码（至少我有源码）并开始研究这个方法。</p>
<p>它似乎优先考虑验证应用程序的域，不仅在它的内部系统，在公共API中也是如此。</p>
<p>如果有一个验证应用程序的域，它不会返回任何其他东西。MATCH_ALL标志会移除一些系统过滤器，但是仅仅是在没有验证程序的情况下。</p>
<p>对于这个问题，我找不到任何可变通的措施。它只是排除浏览器应用，即使他们的IntentFilters匹配。</p>
<p>之所以没有可变通的措施，是因为他是一个内部组件（我们无法访问），Android SDK通过IPC使用AIDL与它进行通信。</p>
<p>大部分开发者使用这个方法来判断是否至少有一个Activity来处理隐式的Intent。在大多数情况下，列表中第一项就是你想要的。</p>
<p>在花了几个小时搞明白到底发生了什么之后，我尝试寻找一个我认为每个人都应该知道的解决方案。</p>
<p>在Android 6.0中，改动的地方很多。实际上谷歌提供了一些改变清单，在清单中你能看到到底有哪些改变。我认为还有很多类似上面的一些没有在清单中列出的改变，而这些改动很有可能导致你的应用无法正常运行。</p>
<p>所以如果你使用PackageManager的方法，你一定得小心，并且认真检查。</p>
<p>感谢此文的校对者：<a href="https://twitter.com/yagmurdalman" target="_blank" rel="external">Yağmur Dalman</a>、<a href="https://medium.com/u/9706138c9bfb" target="_blank" rel="external">Sebastiano Poggi</a>、<a href="https://medium.com/u/73761c65c602" target="_blank" rel="external">Salim KAYABAŞI</a>、<a href="https://medium.com/u/24a0490cd588" target="_blank" rel="external">Hasan Keklik</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liuling07.github.io/2015/12/intent-resolving-in-android-m.html" data-id="ciiy5f4v0009dq1d0o3voue7i" class="article-share-link">Share</a>
      
        <a href="http://liuling07.github.io/2015/12/intent-resolving-in-android-m.html#ds-thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/译文/">译文</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-performance-listviews" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/performance-listviews.html">【译文】高性能ListViews</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2015/12/performance-listviews.html">
      <time datetime="2015-12-02T10:22:14.000Z" itemprop="datePublished">2015-12-02</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Android/">Android</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>原文链接 : <a href="http://willowtreeapps.com/blog/performance-listviews/?utm_source=Android+Weekly&amp;utm_campaign=038d344835-Android_Weekly_178&amp;utm_medium=email&amp;utm_term=0_4eb677ad19-038d344835-337955857" target="_blank" rel="external">Performance ListViews</a><br>原文作者 : <a href="http://willowtreeapps.com/blog/" target="_blank" rel="external">Brandon</a><br>译文出自 : <a href="http://www.devtf.cn" target="_blank" rel="external">开发技术前线 www.devtf.cn。未经允许，不得转载!</a><br>译者 : <a href="https://github.com/liuling07" target="_blank" rel="external">liuling07</a><br>校对者: <a href="https://github.com/desmond1121" target="_blank" rel="external">desmond1121</a><br>状态 : 完成</p>
<h2 id="u8BD1_u6587_u8FDE_u63A5_uFF1A_u9AD8_u6027_u80FDListViews"><a href="#u8BD1_u6587_u8FDE_u63A5_uFF1A_u9AD8_u6027_u80FDListViews" class="headerlink" title="译文连接：高性能ListViews"></a>译文连接：<a href="https://github.com/bboyfeiyu/android-tech-frontier/blob/master/androidweekly/高性能ListViews/高性能ListViews.md" target="_blank" rel="external">高性能ListViews</a></h2><p>列表展示功能几乎在所有app中都会被用到，使用列表可以很方便的展示一些列表项，比如菜谱、联系人，或者任意类型的类别。所以Android有一个内置的方式来展示此类型的数据，也是在情理之中的。RecyclerView是一种最新的展示列表数据的方式，它非常高效，因为它重用视图而不是每一行出现在屏幕上都重新创建。在RecyclerView出现之前，我们可以使用ListView，即使到了现在，ListView也是广泛的被开发者所使用。虽然ListView也是可以回收视图的，但它也一直都是Android中最容易被错误使用的一个控件。我们知道在此之前这个话题已经被写过无数遍了，但是今天我还是要在博客中提出来，因为我们仍然发现很多app在错误的使用它们。</p>
<p>关于ListView中ArrayAdapter的用法，标准的新手写法是这样子的：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@Override&#10;public View getView(int position, View convertView, ViewGroup parent) &#123;&#10; &#10;    LayoutInflater inflater = (LayoutInflater) context&#10;            .getSystemService(Context.LAYOUT_INFLATER_SERVICE);&#10;    View rowView = inflater.inflate(R.layout.view_test_row, parent, false);&#10; &#10;    TextView testName = (TextView)rowView.findViewById(R.id.text_view_test_name);&#10;    TextView testDesc = (TextView)rowView.findViewById(R.id.text_view_test_desc);&#10; &#10;    //modify TextViews, in some arbitrary way&#10; &#10;    return rowView;&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>当所有列表项都能够一次性在一屏中显示的时候，这种写法并没有什么问题，但这样你就创建了一个基本视图，并完全避免了ArrayAdapter的麻烦了吗？当ListView需要显示一个很大的列表集，而且列表子项是一个非常复杂的视图的时候，上面的方式会消耗大量的性能。当用户滑动屏幕的时候，每个视图都会被inflate并且调用findViewById()方法。当findViewById()方法被调用的时候，会遍历整个视图层级，直到找到正确的Id。每个子视图都要执行上述过程！并且用户滑动的越快，卡顿现象愈加明显。为了解决这个问题，我们可以使用一个静态类来绑定还没被使用的convertView。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">static class ViewHolder()&#123;&#10; &#10;        TextView testName;&#10;        TextView testDesc;&#10; &#10;&#125;&#10; &#10;@Override&#10; public View getView(int position, View convertView, ViewGroup parent) &#123;&#10; &#10;    View rowView = convertView;  //reference to one of the previous Views in the list that we can reuse.&#10; &#10;    if(convertView == null) &#123;&#10; &#10;        LayoutInflater inflater = (LayoutInflater) context&#10;                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);&#10;        rowView = inflater.inflate(R.layout.view_test_row, parent, false);&#10; &#10;        ViewHolder viewHolder = new ViewHolder();&#10;        viewHolder.testName = (TextView) rowView.findViewById(R.id.text_view_test_name);&#10;        viewHolder.testDesc = (TextView) rowView.findViewById(R.id.text_view_test_desc);&#10; &#10;        rowView.setTag(viewHolder);&#10;    &#125;&#10; &#10;    ViewHolder holder = (ViewHolder) rowView.getTag();&#10; &#10;    //in real code these strings should be in res&#10;    holder.testName.setText(&#34;Test&#34;+position);&#10;    holder.testDesc.setText(&#34;This is number &#34;+position);&#10; &#10;    return rowView;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>那convertView又是什么呢？它可以让ListView跳过一些显示一行内容所需要的设置。如果某一行的视图不在屏幕中显示，我们可以重复使用这个视图来显示一个新行。当ListView刚开始显示的时候，一切都是正常的。既然没有视图可以被用来复用，convertView为空。视图也像前面版本一样被inflate，但是TextViews会被找到且它的引用被保存在一个ViewHolder中。然后我们可以调用setTag()方法将ViewHolder存储在视图中。正如修订过后的getView()方法中后半段代码所示，我们可以在视图中存储后面我们需要用到的数据。</p>
<p>我们所做的更改可能看起来并没有太大的效果，但是随着布局越来越复杂并且数量也越来越多，效果将变得越来越明显。作为开发者，我最不想做的事就是开发一个用户体验很差的app。所以请记住，仅仅一个低水平的ListView都有可能让一个app死掉，我们一定得避免这种情况发生。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liuling07.github.io/2015/12/performance-listviews.html" data-id="ciiy5f4r3003lq1d08dotwrw6" class="article-share-link">Share</a>
      
        <a href="http://liuling07.github.io/2015/12/performance-listviews.html#ds-thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/译文/">译文</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-android-multi-photo-picker" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/android-multi-photo-picker.html">Android带多选功能的PhotoPicker</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2015/11/android-multi-photo-picker.html">
      <time datetime="2015-11-21T07:46:03.000Z" itemprop="datePublished">2015-11-21</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Android/">Android</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>最近利用闲碎的一些时间开发了一个Android库<a href="https://github.com/liuling07/PhotoPicker" target="_blank" rel="external">PhotoPicker</a>，前面一篇文章也介绍了，<a href="http://www.liuling123.com/2015/11/android-photo-picker.html" target="_blank" rel="external">Android高仿微信图片选择功能的PhotoPicker</a>，之前没有加入选择多张图片的功能，现在加上之后一个完整的PhotoPicker库终于算是完工了。</p>
<h2 id="u52A8_u6001_u6548_u679C_u56FE"><a href="#u52A8_u6001_u6548_u679C_u56FE" class="headerlink" title="动态效果图"></a><strong>动态效果图</strong></h2><p><img src="http://7xnqm4.com1.z0.glb.clouddn.com/photo-picker-sample.gif?watermark/1/image/aHR0cDovLzd4bnFtNC5jb20xLnowLmdsYi5jbG91ZGRuLmNvbS93YXRlcm1hcmsucG5n/dissolve/50/gravity/SouthEast" alt="Android带多选功能的PhotoPicker示例图片" title="Android带多选功能的PhotoPicker示例图片"></p>
<h2 id="u4F7F_u7528_u65B9_u6CD5"><a href="#u4F7F_u7528_u65B9_u6CD5" class="headerlink" title="使用方法"></a><strong>使用方法</strong></h2><p>引入PhotoPicker库，在需要使用图片选择功能的地方添加如下代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Intent intent = new Intent(MainActivity.this, PhotoPickerActivity.class);&#10;intent.putExtra(PhotoPickerActivity.EXTRA_SHOW_CAMERA, showCamera);&#10;intent.putExtra(PhotoPickerActivity.EXTRA_SELECT_MODE, selectedMode);&#10;intent.putExtra(PhotoPickerActivity.EXTRA_MAX_MUN, maxNum);&#10;startActivityForResult(intent, PICK_PHOTO);</span><br></pre></td></tr></table></figure></p>
<p>并且重写activity的onActivityResult方法，处理返回结果。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@Override&#10;protected void onActivityResult(int requestCode, int resultCode, Intent data) &#123;&#10;    super.onActivityResult(requestCode, resultCode, data);&#10;    if(requestCode == PICK_PHOTO)&#123;&#10;        if(resultCode == RESULT_OK)&#123;&#10;             ArrayList&#60;String&#62; result = data.getStringArrayListExtra(PhotoPickerActivity.KEY_RESULT);&#10;            //do what you want to to.&#10;        &#125;&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>源码地址：<a href="https://github.com/liuling07/PhotoPicker" target="_blank" rel="external">https://github.com/liuling07/PhotoPicker</a>，欢迎fork和star。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liuling07.github.io/2015/11/android-multi-photo-picker.html" data-id="ciiy5f4yk00f3q1d05xa08mds" class="article-share-link">Share</a>
      
        <a href="http://liuling07.github.io/2015/11/android-multi-photo-picker.html#ds-thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/图片选择/">图片选择</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/开源/">开源</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-android-photo-picker" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/android-photo-picker.html">Android高仿微信图片选择功能的PhotoPicker</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2015/11/android-photo-picker.html">
      <time datetime="2015-11-15T12:25:01.000Z" itemprop="datePublished">2015-11-15</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Android/">Android</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>类似于微信修改头像的功能基本上每个app都会有，以前公司开发的项目就有修改头像的功能，但是用的Android系统自带的图片选择器。用Android系统的图片选择器有个好处就是稳定，不会有什么问题。但也有它的缺点，比如不可定制，我们想要修改一下符合自己app的风格无法做到。</p>
<p>既然大部分app都要用到图片选择器，为啥我不自己写一个呢？难不成每次都用系统自带的？那显得太没水平。所以，我就有了一个自己编写一个图片选择器的想法，以后只要有项目需要这个功能，直接拿来用就行了，这多爽！</p>
<p>其实github上也有很多大牛写的图片选择开源库，虽然大家一直都推崇不要重复造轮子这个观念，但是我却不这么认为，同样是轮子，也有不同价格、不同品牌的呢，难不成有了一个制造商生产了轮子，其他厂商就没必要做了吗？所以说，重复造轮子也是有意义的，至少你知道轮子是怎么造的。</p>
<p>好了，闲话不多说，先看看效果图：</p>
<p>1、图片选择效果<br><img src="http://7xnqm4.com1.z0.glb.clouddn.com/photo-picker-sample01.png?watermark/1/image/aHR0cDovLzd4bnFtNC5jb20xLnowLmdsYi5jbG91ZGRuLmNvbS93YXRlcm1hcmsucG5n/dissolve/50/gravity/SouthEast" alt="Android高仿微信图片选择功能的PhotoPicker示例图片1" title="Android高仿微信图片选择功能的PhotoPicker示例图片1"></p>
<p>2、弹出文件夹选择效果：<br><img src="http://7xnqm4.com1.z0.glb.clouddn.com/photo-picker-sample02.png?watermark/1/image/aHR0cDovLzd4bnFtNC5jb20xLnowLmdsYi5jbG91ZGRuLmNvbS93YXRlcm1hcmsucG5n/dissolve/50/gravity/SouthEast" alt="Android高仿微信图片选择功能的PhotoPicker示例图片2" title="Android高仿微信图片选择功能的PhotoPicker示例图片2"></p>
<p>这里博主还是只模范微信的头像选择功能，也就是单张图片的选取。而微信发送图片消息的多张图片选择，暂时还没有做。主要是博主现在要学习C++，要快速熟悉cocos2dx的开发，没有时间去弄。后面有时间会把多图选择功能加上。</p>
<p>博主测试3部手机，vivo x3s 826张图片、联想A800 1231张、中兴V955 762张均为出现OOM，且图片加载很流畅。由于测试覆盖率不够，程序难免还会存在一些bug，如果有还望各位不吝指正，谢谢！</p>
<p>这里代码我就不贴了，需要的直接去博主github上fork源码，欢迎fork和star。</p>
<p>源码地址：<a href="https://github.com/liuling07/PhotoPicker" target="_blank" rel="external">https://github.com/liuling07/PhotoPicker</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liuling07.github.io/2015/11/android-photo-picker.html" data-id="ciiy5f4yf00ewq1d0dowf4ld3" class="article-share-link">Share</a>
      
        <a href="http://liuling07.github.io/2015/11/android-photo-picker.html#ds-thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/图片选择/">图片选择</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/开源/">开源</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-lantern" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/lantern.html">科学上网工具Lantern，轻松访问Google、Facebook等被墙网站</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2015/11/lantern.html">
      <time datetime="2015-11-11T14:13:18.000Z" itemprop="datePublished">2015-11-11</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/其他技术/">其他技术</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>给大家推荐一个科学上网的工具，轻松就可以访问google、facebook等被墙的网站：<a href="https://github.com/liuling07/Lantern" target="_blank" rel="external">下载Lantern</a></p>
<p>下载lantern.exe.fbd文件，将.fbd后缀去掉，双击运行即可。可能360会阻止运行，要点击允许。</p>
<p>如下图：<br><a href="http://www.liuling123.com/wp-content/uploads/2015/11/QQ图片20151111215158.png" target="_blank" rel="external"><img src="http://www.liuling123.com/wp-content/uploads/2015/11/QQ图片20151111215158-300x129.png" alt="科学上网工具"></a></p>
<p>该工具只能用于PC端浏览器浏览被墙网站，一般查资料够用了。如果需要玩游戏或者其他用途，建议还是买VPN。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liuling07.github.io/2015/11/lantern.html" data-id="ciiy5f4t1006jq1d0tmpu61zh" class="article-share-link">Share</a>
      
        <a href="http://liuling07.github.io/2015/11/lantern.html#ds-thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/科学上网/">科学上网</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-max-allowed-packet" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/max-allowed-packet.html">MySQL导入数据报Got a packet bigger than‘max_allowed_packet’bytes错误的解决方法</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2015/11/max-allowed-packet.html">
      <time datetime="2015-11-11T13:00:54.000Z" itemprop="datePublished">2015-11-11</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/其他技术/">其他技术</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>   今天将博客的数据库进行了迁移，在执行sql脚本的时候报了Got a packet bigger than‘max_allowed_packet’bytes的错误，上网搜了一下，发现是由于max_allowed_packet的值设置过小的原因，知道原因就好办了，只需要将max_allowed_packet值设置大一点就OK了。<br>   通过终端进入mysql控制台，输入如下命令可以查看max_allowed_packet值的大小。<br>   show VARIABLES like ‘%max_allowed_packet%’;<br>显示的结果为：</p>
<p>+——————–+———+<br>| Variable_name      | Value   |<br>+——————–+———+<br>| max_allowed_packet | 1048576 |<br>+——————–+———+</p>
<p>以上说明目前的配置是：1M<br>执行一下命令可以将max_allowed_packet的值设置大一点：<br>set global max_allowed_packet = 2<em>1024</em>1024*10<br>退出mysql命令行，然后重新登录。<br>show VARIABLES like ‘%max_allowed_packet%’;</p>
<p>设置完之后，再重新导入数据，OK，一切正常。</p>
<p>注意，使用这种方法，重启服务器之后又恢复默认值了。这里博主只是导数据的时候临时将其值设置大一点，导完之后尽量让其恢复原值，因为max_allowed_packet设置过大可能会导致服务器太忙来不及接收，网络差的时候也可能会出现丢包的现象。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liuling07.github.io/2015/11/max-allowed-packet.html" data-id="ciiy5f4se005iq1d0q67r0trv" class="article-share-link">Share</a>
      
        <a href="http://liuling07.github.io/2015/11/max-allowed-packet.html#ds-thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/">mysql</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-cpp-study" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/cpp-study.html">C++学习随笔</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2015/11/cpp-study.html">
      <time datetime="2015-11-10T11:28:33.000Z" itemprop="datePublished">2015-11-10</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/其他技术/">其他技术</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>最近由于公司部门调整，博主被安排去做游戏开发了，使用的是cocos2d游戏引擎，开发语言为C++。所以硬着头皮边熟悉cocos2d边学C++。对于写了多年Java的来说，看C++代码很坑爹有木有。<br>但是作为Android工程师，C/C++还是有必要学的，因为Android系统源码大部分都是C写的。之前看过一段时间的Android源码，看到C++部分也是比较吃力，现在借此机会学学C++也是挺不错的。<br>下面简单记录在学习C++过程中遇到的一些不懂的东西（持续更新）。</p>
<p><strong>std::nothrow</strong></p>
<p>在内存不足时，new (std::nothrow)并不抛出异常，而是将指针置NULL。<br>如：auto layer = new (std::nothrow) FirstLayer();</p>
<p><strong>auto</strong><br>auto是C++11的新特性，自动类型推断，用于从初始化表达式中推断出变量的数据类型，有点类似于js中的弱类型var。</p>
<p><strong>#pragma once</strong><br>只要在头文件的最开始加入这条杂注，就能够保证头文件只被编译一次。但是是依赖编译器的，可以使用宏定义#ifndef</p>
<p><strong>#ifndef，#define，#endif</strong><br>C/C++语言中的宏定义，通过宏定义避免文件多次编译</p>
<p><strong>#if与if的区别</strong></p>
<p>#endif//与#if对应<br>作为一个编译“开关”，比如：   </p>
<p>#if(条件满足)<br>  执行代码1   </p>
<p>#else<br>  执行代码2   </p>
<p>#endif<br>假如编译时，确实满足条件，则生成的程序文件(.exe文件)中不会有执行代码2的。如果用普通if语句，生成的程序文件就会有执行代码2，这个区别看看生成文件大小就可以知道。如果你的条件在程序编译前就已经确定了，那就用#if；如果条件需要在程序运行过程中才能判断，则用if。</p>
<p><strong>static_cast</strong><br>用法：static_cast &lt; type-id &gt; ( expression )<br>该运算符把expression转换为type-id类型，但没有运行时类型检查来保证转换的安全性。有点类似于Java中的强制转换。</p>
<p><strong>string与int拼接</strong><br>1、stringstream拼接string与int</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stringstream ss;&#10;ss &#60;&#60; &#34;old:&#34;&#60;&#60; GameOverScene::goldNum &#60;&#60; &#34;,distance:&#34; &#60;&#60; GameOverScene::distance;&#10;LabelTTF* goldAndDistanceLabel = LabelTTF::create(ss.str(), &#34;Arial&#34;, 30);</span><br></pre></td></tr></table></figure>
<p>2、sprintf函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">char countBuf[16] = &#34;&#34;;&#10;sprintf(countBuf, &#34;distance:%d&#34;, mDistance);</span><br></pre></td></tr></table></figure>
<p>3、std::to_string函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string s = &#34;run0&#34; + std::to_string(i) + &#34;.png&#34;;</span><br></pre></td></tr></table></figure>
<p>安卓没有to_string这个函数，eclipse中编译出错，为了跨平台，尽量使用stringstream或者sprintf</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liuling07.github.io/2015/11/cpp-study.html" data-id="ciiy5f4x500czq1d03ebrqny3" class="article-share-link">Share</a>
      
        <a href="http://liuling07.github.io/2015/11/cpp-study.html#ds-thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/">c++</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-recyclerview-example" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/recyclerview-example.html">RecyclerView的使用</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2015/11/recyclerview-example.html">
      <time datetime="2015-11-04T05:31:59.000Z" itemprop="datePublished">2015-11-04</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Android/">Android</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <h1 id="u4EC0_u4E48_u662FRecyclerView"><a href="#u4EC0_u4E48_u662FRecyclerView" class="headerlink" title="什么是RecyclerView"></a>什么是RecyclerView</h1><pre><code>RecyclerView是Android 5.0 materials design中的组件之一，相应的还有CardView、Palette等。看名字我们就能看出一点端倪，没错，它主要的特点就是复用。我们知道，Listview中的Adapter中可以实现ViewHolder的复用。RecyclerView提供了一个耦合度更低的方式来复用ViewHolder，并且可以轻松的实现ListView、GridView以及瀑布流的效果。
</code></pre><h1 id="RecyclerView_u7684_u7528_u6CD5"><a href="#RecyclerView_u7684_u7528_u6CD5" class="headerlink" title="RecyclerView的用法"></a>RecyclerView的用法</h1><pre><code>首先我们要gradle的依赖库中添加  compile &apos;com.android.support:recyclerview-v7:21.+&apos;  。如果是eclipse直接导入android-support-v7-recyclerview.jar就可以了。
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/**&#10;* &#35774;&#32622;Adapter&#10;*/&#10;mRecyclerView.setAdapter(mListAdapter);&#10;/**&#10;* &#35774;&#32622;&#24067;&#23616;&#31649;&#29702;&#22120;&#10;*/&#10;mRecyclerView.setLayoutManager(linearLayoutManager);&#10;/**&#10;* &#35774;&#32622;item&#20998;&#21106;&#32447;&#10;*/&#10;mRecyclerView.addItemDecoration(itemDecoration);&#10;/**&#10;* &#35774;&#32622;item&#21160;&#30011;&#10;*/&#10;mRecyclerView.setItemAnimator(new DefaultItemAnimator());</span><br></pre></td></tr></table></figure>
<p>使用RecyclerView，基本上要上面四步。相比ListView只需设置Adapter而言，RecyclerView的使用看起来似乎要复杂一些。但是它的可定制性更高了，你可以自己定制自己的分割线样式或者是item的的动画。  </p>
<p>下面我们看下如何使用RecyclerView简单实现ListView的效果。<br>activity:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">package com.bbk.lling.recyclerview;&#10;&#10;import android.support.v7.app.ActionBarActivity;&#10;import android.os.Bundle;&#10;import android.support.v7.widget.DefaultItemAnimator;&#10;import android.support.v7.widget.LinearLayoutManager;&#10;import android.support.v7.widget.RecyclerView;&#10;import android.view.Menu;&#10;import android.view.MenuItem;&#10;import android.view.View;&#10;import android.widget.Toast;&#10;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;&#10;/**&#10; * @Class: ListLayoutActivity&#10; * @Description: RecycleView&#23454;&#29616;listview&#30340;&#21151;&#33021;&#10; * @author: lling(www.liuling123.com)&#10; * @Date: 2015/10/29&#10; */&#10;public class ListLayoutActivity extends ActionBarActivity &#123;&#10;&#10;    private RecyclerView mRecyclerView;&#10;    private ListAdapter mListAdapter;&#10;    private List&#38;lt;String&#38;gt; mDatas;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) &#123;&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_list_layout);&#10;        initData();&#10;        mRecyclerView = (RecyclerView) findViewById(R.id.recyclerview);&#10;        mListAdapter = new ListAdapter(this, mDatas);&#10;        mListAdapter.setOnItemClickListener(new ListAdapter.OnItemClickListener() &#123;&#10;            @Override&#10;            public void onItemClick(View view, int position) &#123;&#10;                Toast.makeText(ListLayoutActivity.this, &#38;quot;Click&#38;quot; + mDatas.get(position), Toast.LENGTH_SHORT).show();&#10;            &#125;&#10;&#10;            @Override&#10;            public void onItemLongClick(View view, int position) &#123;&#10;                mListAdapter.remove(position); //remove the item&#10;                Toast.makeText(ListLayoutActivity.this, &#38;quot;LongClick&#38;quot; + mDatas.get(position), Toast.LENGTH_SHORT).show();&#10;            &#125;&#10;        &#125;);&#10;        mRecyclerView.setAdapter(mListAdapter);&#10;        /**&#10;         * &#35774;&#32622;&#24067;&#23616;&#31649;&#29702;&#22120;&#65292;listview&#39118;&#26684;&#21017;&#35774;&#32622;&#20026;LinearLayoutManager&#10;         * gridview&#39118;&#26684;&#21017;&#35774;&#32622;&#20026;GridLayoutManager&#10;         * pu&#28689;&#24067;&#27969;&#39118;&#26684;&#30340;&#35774;&#32622;&#20026;StaggeredGridLayoutManager&#10;         */&#10;        mRecyclerView.setLayoutManager(new LinearLayoutManager(this));&#10;        // &#35774;&#32622;item&#20998;&#10;        mRecyclerView.addItemDecoration(new ListItemDecoration(this, LinearLayoutManager.VERTICAL));&#10;        // &#35774;&#32622;item&#21160;&#30011;&#10;        mRecyclerView.setItemAnimator(new DefaultItemAnimator());&#10;&#10;    &#125;&#10;&#10;    @Override&#10;    public boolean onCreateOptionsMenu(Menu menu) &#123;&#10;        getMenuInflater().inflate(R.menu.menu_list_layout, menu);&#10;        return true;&#10;    &#125;&#10;&#10;    @Override&#10;    public boolean onOptionsItemSelected(MenuItem item) &#123;&#10;        switch (item.getItemId()) &#123;&#10;            case R.id.add_first:&#10;                mListAdapter.add(0, &#38;quot;add first&#38;quot;);&#10;                break;&#10;            case R.id.add_last:&#10;                mListAdapter.add(mListAdapter.getItemCount(), &#38;quot;add last&#38;quot;);&#10;                break;&#10;            case R.id.remove_first:&#10;                String value = mListAdapter.remove(0);&#10;                Toast.makeText(ListLayoutActivity.this, &#38;quot;remove:&#38;quot; + value, Toast.LENGTH_SHORT).show();&#10;                break;&#10;            case R.id.remove_last:&#10;                String value1 =  mListAdapter.remove(mListAdapter.getItemCount()-1);&#10;                Toast.makeText(ListLayoutActivity.this, &#38;quot;remove:&#38;quot; + value1, Toast.LENGTH_SHORT).show();&#10;                break;&#10;            case R.id.horizontal:&#10;                mRecyclerView.setLayoutManager(new LinearLayoutManager(this, LinearLayoutManager.HORIZONTAL, false));&#10;                mRecyclerView.addItemDecoration(new ListItemDecoration(this, LinearLayoutManager.HORIZONTAL));&#10;                break;&#10;            case R.id.vertical:&#10;                mRecyclerView.setLayoutManager(new LinearLayoutManager(this));&#10;                mRecyclerView.addItemDecoration(new ListItemDecoration(this, LinearLayoutManager.VERTICAL));&#10;                break;&#10;        &#125;&#10;        return super.onOptionsItemSelected(item);&#10;    &#125;&#10;&#10;     /* ==========This Part is not necessary========= */&#10;&#10;    /**&#10;     * Create datas&#10;     */&#10;    protected void initData() &#123;&#10;        mDatas = new ArrayList&#38;lt;String&#38;gt;();&#10;        for (int i = 0; i &#38;lt; 100; i++) &#123;&#10;            mDatas.add(String.valueOf(i));&#10;        &#125;&#10;    &#125;&#10;&#10;    /* ==========This Part is not necessary========= */&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>activity布局：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#60;RelativeLayout xmlns:android=&#34;http://schemas.android.com/apk/res/android&#34;&#10;    xmlns:tools=&#34;http://schemas.android.com/tools&#34;&#10;    android:layout_width=&#34;match_parent&#34;&#10;    android:layout_height=&#34;match_parent&#34; &#62;&#10; &#10;    &#60;android.support.v7.widget.RecyclerView&#10;        android:id=&#34;@+id/recyclerview&#34;&#10;        android:layout_width=&#34;match_parent&#34;&#10;        android:layout_height=&#34;match_parent&#34; /&#62;&#10; &#10;&#60;/RelativeLayout&#62;</span><br></pre></td></tr></table></figure></p>
<p>Adapter：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">package com.bbk.lling.recyclerview;&#10;&#10;import android.annotation.SuppressLint;&#10;import android.content.Context;&#10;import android.support.v7.widget.RecyclerView;&#10;import android.util.Log;&#10;import android.view.LayoutInflater;&#10;import android.view.View;&#10;import android.view.ViewGroup;&#10;import android.widget.TextView;&#10;&#10;import java.util.List;&#10;&#10;/**&#10; * @Class: ListAdapter&#10; * @Description: &#25968;&#25454;&#36866;&#37197;&#22120;&#10; * @author: lling(www.liuling123.com)&#10; * @Date: 2015/10/29&#10; */&#10;public class ListAdapter extends RecyclerView.Adapter&#60;ListAdapter.ItemViewHolder&#62; &#123;&#10;&#10;    private List&#38;lt;String&#38;gt; mDatas;&#10;    private LayoutInflater mInflater;&#10;    private OnItemClickListener mOnItemClickListener;&#10;&#10;    public ListAdapter(Context context, List&#38;lt;String&#38;gt; mDatas) &#123;&#10;        this.mDatas = mDatas;&#10;        mInflater = LayoutInflater.from(context);&#10;    &#125;&#10;&#10;    @Override&#10;    public int getItemCount() &#123;&#10;        return mDatas.size();&#10;    &#125;&#10;&#10;    @SuppressLint(&#38;quot;NewApi&#38;quot;)&#10;    @Override&#10;    public void onBindViewHolder(final ItemViewHolder itemViewHolder, final int i) &#123;&#10;        itemViewHolder.mTextView.setText(mDatas.get(i));&#10;        if(mOnItemClickListener != null) &#123;&#10;            /**&#10;             * &#36825;&#37324;&#21152;&#20102;&#21028;&#26029;&#65292;itemViewHolder.itemView.hasOnClickListeners()&#10;             * &#30446;&#30340;&#26159;&#20943;&#23569;&#23545;&#35937;&#30340;&#21019;&#24314;&#65292;&#22914;&#26524;&#24050;&#32463;&#20026;view&#35774;&#32622;&#20102;click&#30417;&#21548;&#20107;&#20214;,&#23601;&#19981;&#29992;&#37325;&#22797;&#35774;&#32622;&#20102;&#10;             * &#19981;&#28982;&#27599;&#27425;&#35843;&#29992;onBindViewHolder&#26041;&#27861;&#65292;&#37117;&#20250;&#21019;&#24314;&#20004;&#20010;&#30417;&#21548;&#20107;&#20214;&#23545;&#35937;&#65292;&#22686;&#21152;&#20102;&#20869;&#23384;&#30340;&#24320;&#38144;&#10;             */&#10;            if(!itemViewHolder.itemView.hasOnClickListeners()) &#123;&#10;                Log.e(&#38;quot;ListAdapter&#38;quot;, &#38;quot;setOnClickListener&#38;quot;);&#10;                itemViewHolder.itemView.setOnClickListener(new View.OnClickListener() &#123;&#10;                    @Override&#10;                    public void onClick(View v) &#123;&#10;                        int pos = itemViewHolder.getPosition();&#10;                        mOnItemClickListener.onItemClick(v, pos);&#10;                    &#125;&#10;                &#125;);&#10;                itemViewHolder.itemView.setOnLongClickListener(new View.OnLongClickListener() &#123;&#10;                    @Override&#10;                    public boolean onLongClick(View v) &#123;&#10;                        int pos = itemViewHolder.getPosition();&#10;                        mOnItemClickListener.onItemLongClick(v, pos);&#10;                        return true;&#10;                    &#125;&#10;                &#125;);&#10;            &#125;&#10;        &#125;&#10;    &#125;&#10;&#10;    @Override&#10;    public ItemViewHolder onCreateViewHolder(ViewGroup viewGroup, int i) &#123;&#10;        /**&#10;         * &#20351;&#29992;RecyclerView&#65292;ViewHolder&#26159;&#21487;&#20197;&#22797;&#29992;&#30340;&#12290;&#36825;&#26681;&#20351;&#29992;ListView&#30340;VIewHolder&#22797;&#29992;&#26159;&#19968;&#26679;&#30340;&#10;         * ViewHolder&#21019;&#24314;&#30340;&#20010;&#25968;&#22909;&#20687;&#26159;&#21487;&#35265;item&#30340;&#20010;&#25968;+3&#10;         */&#10;        Log.e(&#38;quot;ListAdapter&#38;quot;, &#38;quot;onCreateViewHolder&#38;quot;);&#10;        ItemViewHolder holder = new ItemViewHolder(mInflater.inflate(&#10;                R.layout.item_layout, viewGroup, false));&#10;        return holder;&#10;    &#125;&#10;&#10;    /**&#10;     * &#21521;&#25351;&#23450;&#20301;&#32622;&#28155;&#21152;&#20803;&#32032;&#10;     * @param position&#10;     * @param value&#10;     */&#10;    public void add(int position, String value) &#123;&#10;        if(position &#38;gt; mDatas.size()) &#123;&#10;            position = mDatas.size();&#10;        &#125;&#10;        if(position &#38;lt; 0) &#123;&#10;            position = 0;&#10;        &#125;&#10;        mDatas.add(position, value);&#10;        /**&#10;         * &#20351;&#29992;notifyItemInserted/notifyItemRemoved&#20250;&#26377;&#21160;&#30011;&#25928;&#26524;&#10;         * &#32780;&#20351;&#29992;notifyDataSetChanged()&#21017;&#27809;&#26377;&#10;         */&#10;        notifyItemInserted(position);&#10;    &#125;&#10;&#10;    /**&#10;     * &#31227;&#38500;&#25351;&#23450;&#20301;&#32622;&#20803;&#32032;&#10;     * @param position&#10;     * @return&#10;     */&#10;    public String remove(int position) &#123;&#10;        if(position &#38;gt; mDatas.size()-1) &#123;&#10;            return null;&#10;        &#125;&#10;        String value = mDatas.remove(position);&#10;        notifyItemRemoved(position);&#10;        return value;&#10;    &#125;&#10;&#10;    public void setOnItemClickListener(OnItemClickListener mOnItemClickListener) &#123;&#10;        this.mOnItemClickListener = mOnItemClickListener;&#10;    &#125;&#10;&#10;    /**&#10;     * &#22788;&#29702;item&#30340;&#28857;&#20987;&#20107;&#20214;&#21644;&#38271;&#25353;&#20107;&#20214;&#10;     */&#10;    interface OnItemClickListener &#123;&#10;        public void onItemClick(View view, int position);&#10;        public void onItemLongClick(View view, int position);&#10;    &#125;&#10;&#10;    class ItemViewHolder extends RecyclerView.ViewHolder &#123;&#10;&#10;        private TextView mTextView;&#10;&#10;        public ItemViewHolder(View itemView) &#123;&#10;            super(itemView);&#10;            mTextView = (TextView) itemView.findViewById(R.id.textview);&#10;        &#125;&#10;    &#125;&#10;&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>这里值得注意的是，RecyclerView并没有提供setOnItemClickListener方法来设置item的点击事件，所以这里我们自己来实现item的点击事件，这点很坑爹有木有？没有就自己设置呗！上面代码121-124定义了一个点击接口。然后给Adapter设置定义的接口对象，然后在onBindViewHolder中为每个holder设置点击事件就行了。但是有一点得注意，因为只要滑动RecyclerView，onBindViewHolder就会不停的调用，如果不加判断的话，则会不停的创建新的点击事件对象，浪费内存，所以在设置点击事件之前需要判断一下是否已经设置过了（如上面代码46行），如果设置过了就不需要创建了。</p>
<p>item的布局：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#60;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&#62;&#10;&#60;RelativeLayout xmlns:android=&#34;http://schemas.android.com/apk/res/android&#34;&#10;    android:layout_width=&#34;match_parent&#34;&#10;    android:layout_height=&#34;match_parent&#34;&#62;&#10;    &#60;TextView&#10;        android:id=&#34;@+id/textview&#34;&#10;        android:layout_width=&#34;wrap_content&#34;&#10;        android:layout_height=&#34;48dp&#34;&#10;        android:minWidth=&#34;48dp&#34;&#10;        android:gravity=&#34;center&#34;&#10;        android:layout_centerInParent=&#34;true&#34;&#10;        android:text=&#34;XXX&#34;/&#62;&#10;&#60;/RelativeLayout&#62;</span><br></pre></td></tr></table></figure></p>
<p>item分割线：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">package com.bbk.lling.recyclerview;&#10;&#10;import android.content.Context;&#10;import android.graphics.Canvas;&#10;import android.graphics.Rect;&#10;import android.graphics.drawable.Drawable;&#10;import android.support.v7.widget.LinearLayoutManager;&#10;import android.support.v7.widget.RecyclerView;&#10;import android.view.View;&#10;&#10;/**&#10; * @Class: ListItemDecoration&#10; * @Description: listview&#30340;item&#20998;&#21106;&#32447;&#10; * @author: lling(www.liuling123.com)&#10; * @Date: 2015/10/29&#10; */&#10;public class ListItemDecoration extends RecyclerView.ItemDecoration &#123;&#10;&#10;    private Drawable mDrawable;&#10;&#10;    private final static int DEFAULT_ORENTATION = LinearLayoutManager.VERTICAL;&#10;&#10;    private int mOrientation;&#10;&#10;    public ListItemDecoration(Context context, int orientation) &#123;&#10;        if(orientation != LinearLayoutManager.HORIZONTAL &#38;amp;&#38;amp; orientation != LinearLayoutManager.VERTICAL) &#123;&#10;            this.mOrientation = DEFAULT_ORENTATION;&#10;        &#125; else &#123;&#10;            this.mOrientation = orientation;&#10;        &#125;&#10;        mDrawable = context.getResources().getDrawable(R.drawable.divider);&#10;    &#125;&#10;&#10;    @Override&#10;    public void onDraw(Canvas c, RecyclerView parent, RecyclerView.State state) &#123;&#10;        if(mOrientation == LinearLayoutManager.HORIZONTAL) &#123;&#10;            drawHorizontal(c, parent);&#10;        &#125; else &#123;&#10;            drawVertical(c, parent);&#10;        &#125;&#10;    &#125;&#10;&#10;    private void drawHorizontal(Canvas c, RecyclerView parent) &#123;&#10;        int top = parent.getPaddingTop();&#10;        int bottom = parent.getHeight() - parent.getPaddingBottom();&#10;&#10;        int childCount = parent.getChildCount();&#10;        for (int i = 0; i &#38;lt; childCount; i++) &#123;&#10;            View child = parent.getChildAt(i);&#10;            RecyclerView.LayoutParams params = (RecyclerView.LayoutParams) child&#10;                    .getLayoutParams();&#10;            int left = child.getRight() + params.rightMargin;&#10;            int right = left + mDrawable.getIntrinsicHeight();&#10;            mDrawable.setBounds(left, top, right, bottom);&#10;            mDrawable.draw(c);&#10;        &#125;&#10;    &#125;&#10;&#10;    private void drawVertical(Canvas c, RecyclerView parent) &#123;&#10;        int left = parent.getPaddingLeft();&#10;        int right = parent.getWidth() - parent.getPaddingRight();&#10;&#10;        int childCount = parent.getChildCount();&#10;        for (int i = 0; i &#38;lt; childCount; i++) &#123;&#10;            View child = parent.getChildAt(i);&#10;            android.support.v7.widget.RecyclerView v = new android.support.v7.widget.RecyclerView(parent.getContext());&#10;            RecyclerView.LayoutParams params = (RecyclerView.LayoutParams) child&#10;                    .getLayoutParams();&#10;            int top = child.getBottom() + params.bottomMargin;&#10;            int bottom = top + mDrawable.getIntrinsicHeight();&#10;            mDrawable.setBounds(left, top, right, bottom);&#10;            mDrawable.draw(c);&#10;        &#125;&#10;    &#125;&#10;&#10;    @Override&#10;    public void getItemOffsets(Rect outRect, View view, RecyclerView parent, RecyclerView.State state) &#123;&#10;        super.getItemOffsets(outRect, view, parent, state);&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>divider.xml：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#60;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&#62;&#10;&#60;shape xmlns:android=&#34;http://schemas.android.com/apk/res/android&#34; android:shape=&#34;rectangle&#34; &#62;&#10;    &#60;size android:height=&#34;1dp&#34; android:width=&#34;1dp&#34;/&#62;&#10;    &#60;!--&#60;solid android:color=&#34;#e0e0e0&#34;/&#62;--&#62;&#10;    &#60;solid android:color=&#34;#ff0000&#34;/&#62;&#10;&#60;/shape&#62;</span><br></pre></td></tr></table></figure></p>
<p>好了，ListView的效果已经实现了，看下效果图  </p>
<p><a href="https://raw.githubusercontent.com/liuling07/RecyclerView/master/example1.gif" target="_blank" rel="external"><img src="https://raw.githubusercontent.com/liuling07/RecyclerView/master/example1.gif" alt=""></a></p>
<p>RecyclerView实现GridView以及瀑布流效果的代码这里就不贴出来了，demo源码里面有，需要的可以下载看看。</p>
<p>demo源码下载：<a href="https://github.com/liuling07/RecyclerView" target="_blank" rel="external">https://github.com/liuling07/RecyclerView</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liuling07.github.io/2015/11/recyclerview-example.html" data-id="ciiy5f4qw003bq1d075vxonb4" class="article-share-link">Share</a>
      
        <a href="http://liuling07.github.io/2015/11/recyclerview-example.html#ds-thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <nav id="page-nav">
        <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
      </nav>
    </section>
      
        <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新博文</h3>
    <div class="widget">
      <ul id="recent-post" class="no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/人生感悟/">人生感悟</a></p>
              <p class="item-title"><a href="/2015/12/say-bye-to-my-2015.html" class="title">Say bye to my 2015</a></p>
              <p class="item-date"><time datetime="2015-12-25T09:25:10.000Z" itemprop="datePublished">2015-12-25</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/Android/">Android</a></p>
              <p class="item-title"><a href="/2015/12/mvp-pattern-android.html" class="title">MVP模式在Android项目中的使用</a></p>
              <p class="item-date"><time datetime="2015-12-23T14:16:04.000Z" itemprop="datePublished">2015-12-23</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/Android/">Android</a></p>
              <p class="item-title"><a href="/2015/12/intent-resolving-in-android-m.html" class="title">【译文】Android M中Intent的解析</a></p>
              <p class="item-date"><time datetime="2015-12-04T06:52:06.000Z" itemprop="datePublished">2015-12-04</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/Android/">Android</a></p>
              <p class="item-title"><a href="/2015/12/performance-listviews.html" class="title">【译文】高性能ListViews</a></p>
              <p class="item-date"><time datetime="2015-12-02T10:22:14.000Z" itemprop="datePublished">2015-12-02</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/Android/">Android</a></p>
              <p class="item-title"><a href="/2015/11/android-multi-photo-picker.html" class="title">Android带多选功能的PhotoPicker</a></p>
              <p class="item-date"><time datetime="2015-11-21T07:46:03.000Z" itemprop="datePublished">2015-11-21</time></p>
            </div>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">博文分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a><span class="category-list-count">21</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Framework/">Framework</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hadoop/">Hadoop</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JNI-amp-NDK/">JNI&amp;NDK</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java基础/">Java基础</a><span class="category-list-count">35</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/NoSQL/">NoSQL</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/人生感悟/">人生感悟</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/其他技术/">其他技术</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端/">前端</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/后端/">后端</a><span class="category-list-count">29</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据结构和算法/">数据结构和算法</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/设计模式/">设计模式</a><span class="category-list-count">7</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/AsyncTask/" style="font-size: 11.54px;">AsyncTask</a> <a href="/tags/LruCache/" style="font-size: 10px;">LruCache</a> <a href="/tags/MVP/" style="font-size: 10px;">MVP</a> <a href="/tags/NoSQL/" style="font-size: 13.08px;">NoSQL</a> <a href="/tags/android/" style="font-size: 18.46px;">android</a> <a href="/tags/android-studio/" style="font-size: 10px;">android studio</a> <a href="/tags/c/" style="font-size: 10px;">c++</a> <a href="/tags/camera/" style="font-size: 10px;">camera</a> <a href="/tags/framework/" style="font-size: 10.77px;">framework</a> <a href="/tags/hadoop/" style="font-size: 14.62px;">hadoop</a> <a href="/tags/java/" style="font-size: 20px;">java</a> <a href="/tags/jni/" style="font-size: 13.08px;">jni</a> <a href="/tags/linux/" style="font-size: 16.15px;">linux</a> <a href="/tags/mysql/" style="font-size: 11.54px;">mysql</a> <a href="/tags/redis/" style="font-size: 13.08px;">redis</a> <a href="/tags/spring/" style="font-size: 10.77px;">spring</a> <a href="/tags/sqlite/" style="font-size: 10px;">sqlite</a> <a href="/tags/web后端/" style="font-size: 19.23px;">web后端</a> <a href="/tags/内存缓存/" style="font-size: 10px;">内存缓存</a> <a href="/tags/前端/" style="font-size: 13.85px;">前端</a> <a href="/tags/反射/" style="font-size: 10px;">反射</a> <a href="/tags/图片选择/" style="font-size: 10.77px;">图片选择</a> <a href="/tags/多线程/" style="font-size: 17.69px;">多线程</a> <a href="/tags/布局/" style="font-size: 12.31px;">布局</a> <a href="/tags/布局优化/" style="font-size: 10.77px;">布局优化</a> <a href="/tags/开源/" style="font-size: 10.77px;">开源</a> <a href="/tags/断点续传/" style="font-size: 11.54px;">断点续传</a> <a href="/tags/科学上网/" style="font-size: 10px;">科学上网</a> <a href="/tags/自定义控件/" style="font-size: 10px;">自定义控件</a> <a href="/tags/解决方案/" style="font-size: 16.92px;">解决方案</a> <a href="/tags/设计模式/" style="font-size: 15.38px;">设计模式</a> <a href="/tags/译文/" style="font-size: 10.77px;">译文</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">博文归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08/">August 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/04/">April 2014</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/03/">March 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/12/">December 2013</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/11/">November 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/09/">September 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/08/">August 2013</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/07/">July 2013</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/06/">June 2013</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/05/">May 2013</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/04/">April 2013</a><span class="archive-list-count">19</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/03/">March 2013</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/02/">February 2013</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/01/">January 2013</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/12/">December 2012</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/11/">November 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/08/">August 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/07/">July 2012</a><span class="archive-list-count">8</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap widget-list">
    <h3 class="widget-title">友情链接</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a target="_blank" href="http://blog.daimajia.com">代码家</a>
          </li>
        
          <li>
            <a target="_blank" href="http://www.trinea.cn">Trinea</a>
          </li>
        
          <li>
            <a target="_blank" href="https://www.aswifter.com">APP开发者</a>
          </li>
        
          <li>
            <a target="_blank" href="http://blog.seoui.com">笑松小站</a>
          </li>
        
          <li>
            <a target="_blank" href="http://www.apkfuns.com">舞影凌风</a>
          </li>
        
          <li>
            <a target="_blank" href="http://www.ttfde.org">TTF的家园</a>
          </li>
        
          <li>
            <a target="_blank" href="http://rocko.xyz">Rocko&#39;s blog</a>
          </li>
        
          <li>
            <a target="_blank" href="http://www.93sec.cc">教程资源网</a>
          </li>
        
      </ul>
    </div>
  </div>


  
  <div id="toTop" class="fa fa-chevron-up"></div>
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2000 - 2016 Lauren<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div>
  </div>
</footer>
    

<script type="text/javascript">
  var duoshuoQuery = {short_name:"liuling07"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
     || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script>





 <script src="//ajax.lug.ustc.edu.cn/ajax/libs/jquery/2.1.3/jquery.min.js"></script>




  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>